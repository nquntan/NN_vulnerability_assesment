import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
sns.set_style('white')
import pandas as pd
from art.utils import load_dataset


def plot_image(image):
    plt.figure(figsize=[60, 20])


def load_data():
    (x_train, y_train), (x_test, y_test), min_, max_ = load_dataset(str('cifar10'))
    return (x_train, y_train), (x_test, y_test), min_, max_ 

def loss_fn(pred_y, current_y, mode = "l2"):
    if mode == "l2":
        return np.linalg.norm(pred_y - current_y, ord=2)
    elif mode == "fool_rate":
        y_max = np.argmax(pred_y, axis=1)
        cullent_label = np.argmax(current_y, axis=1)
        return np.sum(y_max != cullent_label) / len(y_max)
